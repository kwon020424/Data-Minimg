library(rpart)
data(iris)
c<- rpart(Species ~., data=iris)
c
plot(c, compress = T, margin=0.3)
text(c, cex=1.5)

#나무분석 모형으로 예측하고 결과 확인
pc<-predict(c, newdata=iris, type="class")
summary(pc)
table(pc, iris$Species, dnn=c("Actual", "Predicted"))
mean(iris$Species==pc)

#cp값 지정 해서 예측
bc<- rpart(Species ~.,data=iris,cp=0.01)
pbc<- predict(bc,newdata=iris,type="class")
bc$cptable
table(pbc, iris$Species, dnn=c("Actual", "Predicted"))
mean(iris$Species==pbc)